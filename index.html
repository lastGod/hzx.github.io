<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="简体中文">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.6.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.6.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.6.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.6.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="hzx&#39;s Home">
<meta property="og:url" content="https://lastgod.github.io/index.html">
<meta property="og:site_name" content="hzx&#39;s Home">
<meta property="og:locale" content="简体中文">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="hzx&#39;s Home">






  <link rel="canonical" href="https://lastgod.github.io/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>hzx's Home</title>
  











  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="简体中文">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">hzx's Home</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lastgod.github.io/2018/12/11/优先级队列-邻接矩阵-Dijkstra算法/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Author">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hzx's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/12/11/优先级队列-邻接矩阵-Dijkstra算法/" class="post-title-link" itemprop="https://lastgod.github.io/index.html">优先级队列+邻接矩阵+Dijkstra算法</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-12-11 19:09:13 / Modified: 19:09:58" itemprop="dateCreated datePublished" datetime="2018-12-11T19:09:13+08:00">2018-12-11</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="优先级队列-邻接矩阵-Dijkstra算法"><a href="#优先级队列-邻接矩阵-Dijkstra算法" class="headerlink" title="优先级队列+邻接矩阵+Dijkstra算法"></a>优先级队列+邻接矩阵+Dijkstra算法</h1><h3 id="DijkStra算法代码"><a href="#DijkStra算法代码" class="headerlink" title="DijkStra算法代码"></a>DijkStra算法代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义Edge表示每一条边，from是始点，to是汇点，distance表示距离</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> from, to, distance;</span><br><span class="line">	Edge(<span class="keyword">int</span> f, <span class="keyword">int</span> t, <span class="keyword">int</span> d) :from(f), to(t), distance(d) &#123;&#125;;</span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(<span class="keyword">const</span> Edge&amp; e)<span class="keyword">const</span> &#123; <span class="keyword">return</span> <span class="keyword">this</span>-&gt;distance &gt; e.distance; &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// graph 表示图，以邻接矩阵形式表示，其中0编号顶点不算在图中。</span></span><br><span class="line"><span class="comment">// source表示源点</span></span><br><span class="line"><span class="comment">// distance表示从source到其他顶点的距离数组</span></span><br><span class="line"><span class="comment">// visit[i]表示顶点i是否在源点所在的集合中</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dijkstra</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; graph, <span class="keyword">const</span> <span class="keyword">int</span> source, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; distance)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; visit(graph.size(), <span class="number">0</span>);</span><br><span class="line">	priority_queue&lt;Edge&gt; myQueue;</span><br><span class="line">	visit[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	visit[source] = <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// 初始时往优先级队列中加入从源点发出的所有的边</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; graph.size(); ++i)</span><br><span class="line">		<span class="keyword">if</span>(visit[i]==<span class="number">0</span>)</span><br><span class="line">			myQueue.emplace(source, i, distance[i]);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span> (!myQueue.empty()) &#123;</span><br><span class="line">		Edge e = myQueue.top();</span><br><span class="line">		myQueue.pop();</span><br><span class="line">		<span class="keyword">if</span> (visit[e.to] == <span class="number">1</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		visit[e.to] = <span class="number">1</span>;</span><br><span class="line">		distance[e.to] = e.distance;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; graph.size(); ++j) &#123;</span><br><span class="line">			<span class="keyword">if</span> (visit[j] == <span class="number">0</span> &amp;&amp; distance[e.to] + graph[e.to][j] &lt; distance[j])&#123;</span><br><span class="line">				myQueue.emplace(e.to, j, distance[e.to] + graph[e.to][j]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="复杂度分析"><a href="#复杂度分析" class="headerlink" title="复杂度分析"></a>复杂度分析</h3><p>最多每条边都进入优先级队列，每次进入后队列调整用时logm，所以复杂度为O(mlogn)</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lastgod.github.io/2018/12/04/康奈尔大学IC3实验室研究方向整理/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Author">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hzx's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/12/04/康奈尔大学IC3实验室研究方向整理/" class="post-title-link" itemprop="https://lastgod.github.io/index.html">康奈尔大学IC3研究院介绍</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-12-04 19:19:37" itemprop="dateCreated datePublished" datetime="2018-12-04T19:19:37+08:00">2018-12-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-12-06 10:02:38" itemprop="dateModified" datetime="2018-12-06T10:02:38+08:00">2018-12-06</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<h2 id="IC3研究院简介"><a href="#IC3研究院简介" class="headerlink" title="IC3研究院简介"></a>IC3研究院简介</h2><p><a href="https://www.initc3.org/projects.html" target="_blank" rel="noopener">康奈尔大学IC3研究院</a>致力于促进区块链技术的研究和应用(Advancing the Science and Applications of Blockchains).由康奈尔大学（Cornell University）、Cornell Tech、加州大学伯克利分校（UC Berkeley）、伊利诺伊大学（University of Illinois）厄巴纳校区和香槟校区以及以色列理工学院（Technion）的联合组成。</p>
<p>IC3研究院的主要目的：</p>
<ul>
<li><strong>Blockchain Science</strong>：将区块链科学部署到区块链科技应用的第一线中。由于当前的数字货币和合约依赖于启发式设计，至今都没有一个能够保证合约和数字货币足够安全属性的设计标准，建立一套高效的，可面向大规模、高安全性的区块链解决方案是IC3亟待解决的问题。</li>
<li><strong>Blockchain Code</strong>：在坚实的科学基础的支持下，提供代码中的区块链创新。IC3合作开发并验证众多开源区块链工具和解决方案以满足金融行业在成本、安全、隐私和性能方面的需求。其区块链试验台Miniature World可以大规模模拟真实世界场景; 例如比特币运营系统规模的15％的实验，比较了比特币和Bitcoin-NG，一种由IC3开创的新型高性能区块链协议。</li>
</ul>
<h2 id="IC3研究院的研究目标"><a href="#IC3研究院的研究目标" class="headerlink" title="IC3研究院的研究目标"></a>IC3研究院的研究目标</h2><p>IC3研究院的研究项目涉及到了6大挑战：</p>
<ul>
<li><strong>区块链扩展能力和性能</strong>：扩展区块链以使得公链和联盟连可以处理密集的全局工作，以及支持每秒可以处理100,000事务的能力。</li>
<li><strong>设计和构建的正确性</strong>：通过编程语言方面的技术构建正确的代码和具有安全性证明的加密协议使得区块链开发人员能够设计安全的协议、编写正确的代码。</li>
<li><strong>保密性</strong>：利用加密技术和可信的硬件，将透明性和安全性在区块链中结合起来。</li>
<li><strong>提供可信数据</strong>：为区块链提供可靠的、鲁邦的数据供给系统，贡献高可信的数据提供方案。</li>
<li><strong>安全和合规性</strong>：通过评估传统合同法和智能合约中的犯罪风险，为区块链的有效监测和有针对性干预提供技术和协议。</li>
<li><strong>系统兼容</strong>：为区块链部署制定实用的迁移方式，实现新区块链系统与遗留系统的集成。</li>
</ul>
<h2 id="IC3的研究项目"><a href="#IC3的研究项目" class="headerlink" title="IC3的研究项目"></a>IC3的研究项目</h2><ul>
<li><p><strong><a href="https://thehydra.io/" target="_blank" rel="noopener">Hydra</a></strong>：Hydra是一个先进的以太坊合同开发框架，用于去中心化安全和bug赏金，该框架通过严格的加密经济安全保证减轻程序员和编译器错误。</p>
</li>
<li><p><strong>Solidus</strong>：Solidus是可供 银行、政府、审计等使用的联盟连，它拥有区块链的去中心化特点的同时，但是相较现有的比特币系统，具有更高性能、提供更有力的监管和控制，许多成功的点对点技术历来被集中式或商用系统取代。Solidus解决了许多金融机构的期望——即数字货币和合约遵循相同的流程。</p>
</li>
<li><p><strong>Bitcoin-NG</strong>：由IC3牵头制定的一个行的区块链协议，致力于解决比特币的可扩展性问题，使得比特币网络能够在有限的网络环境下达到最高的吞吐量。不仅能够提高吞吐量，还能减少交易延迟，甚至可以达到秒级的交易确认速度。同时Bitcoin-NG不改变比特币开放性的架构和信任模式。</p>
</li>
<li><p><strong>Miniature World</strong>：一个可模拟真实世界区块链的区块链实验平台。由大约1000个节点组成。 该测试平台使我们能够在不同的区块链和各种用例上运行实验，使用现实的互联网延迟来评估真实场景（如上面针对比特币NG所引用的）。 目的是为行业赞助商提供微型世界，以评估各种区块链及其使用案例。看起来并不免费。</p>
</li>
<li><p><strong>Fruitchain</strong>：一种新的激励兼容区块链的方法。今天的大部分区块链，比如比特币，都不是“激励兼容”，这意味着他们很容易受到不诚实对手的战略游戏的影响。 IC3已经证明，比特币区块链可以被矿工或采矿池所破坏，其采集散列功率远低于50％。 Fruitchain是一种创新的区块链方法，它可以阻止不诚实的游戏，使其对于具有低于50％的散列能力的对手来说极其无利可图，实现了ε-均衡或近纳什均衡。（在机制设计理论中，一个程序称为是激励相容的，若所有的参与者若依机制在诚实地揭示任何被要求的私有资讯时，会得到最好的成果。）</p>
</li>
<li><strong><a href=" http://www.falcon-net.org." target="_blank" rel="noopener">Falcon Network</a></strong>：用于区块链的高性能广域互连网，Falcon Network通过最少的验证和直通路由实现了超越当前方法的收益。 客户端不需要特殊软件，它基本上比所有其他已知技术更快。</li>
<li><strong>FLAC</strong>：实际应用程序通常根据动态计算做出授权决策。 如果攻击者可能不正确地影响授权计算，则系统的完整性可能会受到影响。 由于授权决策通常基于敏感数据（如成员列表和密码），因此授权也可能会影响机密性。 Flow-Limited Authorization Calculus（FLAC）既是用于推理动态授权的简单，富有表现力的模型，也是用于安全地实现各种授权机制的语言。 即使对于包含并实现丰富的动态授权机制的程序，FLAC也提供了强大的端到端信息安全保障。</li>
<li><strong>去中心化理论与研究</strong>：这项工作探索了开放去中心化系统的安全性和稳定性的理论基础。 去中心化的好处包括抵抗多种攻击，多样性和权力分散。 比特币的新颖性和鼓舞人心的成功提供了新的证据，证明安全的去中心化系统比以前想象的更可行。  IC3和合作者刚刚发布了一份研究论文，分析了数字自治组织（DAO）及其投票机制。 本文确定了DAO机制设计中存在的问题，即激励投资者采取战略行为;这与他们的偏好真实投票不一致。<br>–<strong><a href="http://oblivm.com/hawk" target="_blank" rel="noopener">Hawk</a></strong>：隐私保护区块链和智能合约。现有的基于区块链的加密货币（如比特币和以太坊）将所有金融交易存储在区块链中。 这牺牲了金融交易的隐私，这在许多应用程序中都是必不可少的。 Hawk是一种基于区块链的智能合约系统，它在区块链上存储加密交易，并依靠加密技术来保留加密货币的安全性。</li>
<li><p><strong><a href="http://www.initc3.org/files/tc.pdf" target="_blank" rel="noopener">Town Crier</a></strong>：智能合约的认证数据源。为了推理现实世界，加密货币系统中的智能合约将依赖于我们称之为认证数据馈送（ADF）的信息输入; 此类信息可包括股票价格，气象报告，新闻和其他当前事件。 因此，在提供安全性以防止试图影响合同结果的攻击者操纵的意义上，重要的是ADF是值得信赖的。 通过利用可信硬件为客户合同提供可靠，数字签名的数据证明，Town Crier系统可以在对其运营商的最小信任假设下充当值得信赖的ADF。</p>
</li>
<li><p><strong><a href="http://virtual-notary.org" target="_blank" rel="noopener">虚拟公证</a></strong>：免费安全的电子证明服务。虚拟公证是一种证明网上事实的服务。虚拟公证人在比特币块链上发行独立证书和不可变记录。它已运行超过3年，并认证超过600000个事实。</p>
</li>
<li><p><strong><a href=" http://etherscrape.com" target="_blank" rel="noopener">EtherScrape</a></strong>:以太坊中的智能合约是用高级编程语言（通常是Serpent或Solidity）编写的，然后编译成以太网虚拟机的字节码。 此编译步骤删除了高级源代码中的许多有用信息，例如注释，变量名称等。如果您可以识别合同的高级源代码，则更有可能搞清楚 它能做什么。 EtherScrape使用指纹识别将区块链上的每个智能合约（即编译的字节码）与创建它的高级源代码相匹配。</p>
</li>
<li><p><strong><a href=" http://www.initc3.org/files/Gyges.pdf" target="_blank" rel="noopener">Gyges</a></strong>:去中心化智能合约中的犯罪。“比特币2.0”最广泛期望的两个目标是隐私和更具表现力的智能合约。数字货币的许多用途对隐私有着明确和合法的需求（例如，金融服务公司被期望保护其客户交易的隐私）。通用的智能合约编程框架使得修补、打造原型和搜索下一个“杀手级应用程序”数字货币变得容易。这两个方向似乎相互矛盾；然而，通过使用复杂的加密技术（如零知识证明和多方计算），我们探索如何同时实现这两个目标。</p>
</li>
<li><p><strong><a href="https://eprint.iacr.org/2016/199.pdf" target="_blank" rel="noopener">HoneyBadgerBFT</a></strong>：HoneyBadgerBFT是第一个实用的异步BFT协议，它可以在不做任何时序假设的情况下保证实时性。 我们的解决方案基于一种新颖的原子广播协议，可实现最佳的渐近效率。 我们提出了一个实现和实验结果，以表明我们的系统可以实现每秒数万个事务的吞吐量，并可扩展到广域网上的一百多个节点。 我们甚至在Tor上进行BFT实验，无需调整任何参数。 与其他选择不同，HoneyBadgerBFT根本不关心底层网络。</p>
</li>
<li><strong><a href=" https://www.cs.cornell.edu/People/egs/papers/teechan.pdf" target="_blank" rel="noopener">Teechan</a></strong>：Teechan是一种新的可伸缩性解决方案，IC3最初是为比特币开发的，但是对于允许的块链也有广泛的应用。Teechan使用可信执行环境（TEE）来保护用户凭据。它是一种新的、实用的、高吞吐量的、低延迟的离链事务协议，可以安全地部署在比特币网络上，就像现在存在的那样。</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lastgod.github.io/2018/12/02/带通配符的字符串匹配/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Author">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hzx's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/12/02/带通配符的字符串匹配/" class="post-title-link" itemprop="https://lastgod.github.io/index.html">带通配符的字符串匹配</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-12-02 10:49:53" itemprop="dateCreated datePublished" datetime="2018-12-02T10:49:53+08:00">2018-12-02</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-12-03 13:30:40" itemprop="dateModified" datetime="2018-12-03T13:30:40+08:00">2018-12-03</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<p>地址： <a href="http://noi.openjudge.cn/ch0206/6252/" target="_blank" rel="noopener">http://noi.openjudge.cn/ch0206/6252/</a></p>
<h2 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h2><p>通配符是一类键盘字符，当我们不知道真正字符或者不想键入完整名字时，常常使用通配符代替一个或多个真正字符。通配符有问号(?)和星号(*)等，其中，“?”可以代替一个字符，而“*”可以代替零个或多个字符。 </p>
<p>你的任务是，给出一个带有通配符的字符串和一个不带通配符的字符串，判断他们是否能够匹配。 </p>
<p>例如，1?456 可以匹配 12456、13456、1a456，但是却不能够匹配23456、1aa456；<br>2*77?8可以匹配 24457798、237708、27798。</p>
<h2 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h2><p>使用动态规划，即可，但是’*‘可以代表空字符串，一个字符串和多个字符串，所以遇到’*‘的时候需要额外的处理。<br>假设F[i][j]表示长度为i第一个字符串X和长度为j的第二个字符串Y进行匹配，长度为i对应的字符是X[i-1]（字符串下标从0开始计算）,长度为j对应于Y的字符Y[j-1]。</p>
<ul>
<li>如果X[i-1]是’?’，那么F[i][j] = F[i-1][j-1], 因为’?’可以匹配任意单个字符。</li>
<li>如果X[i-1]是‘*’，由于’*‘可以表示任意多个字符，所以此时对应关系为：<ul>
<li>F[i][j] = F[i-1][j] || F[i-1][j-1]||F[i][j-1]  ;三个关系式分别对应’*‘表示0、1、多个字符。</li>
</ul>
</li>
<li>如果X[i-1]是普通字符，F[i][j] = X[i-1] == Y[j-1];</li>
</ul>
<h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">match</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; str1, <span class="keyword">const</span> <span class="built_in">string</span>&amp; str2)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt;&gt; F(str1.size() + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt;(str2.size() + <span class="number">1</span>, <span class="literal">false</span>));</span><br><span class="line">	<span class="comment">// 这里用于初始化，F[0][0] = true;F[i][0]是否为true需要看X[i-1]是否为'\*'</span></span><br><span class="line">	F[<span class="number">0</span>][<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= str1.size(); ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (str1[i - <span class="number">1</span>] == <span class="string">'*'</span>)</span><br><span class="line">			F[i][<span class="number">0</span>] = F[i - <span class="number">1</span>][<span class="number">0</span>];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// F[i][j]表示长度为i的str1和长度为j的str2是否匹配</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= str1.size(); ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= str2.size(); ++j) &#123;</span><br><span class="line">			<span class="keyword">if</span> (str1[i - <span class="number">1</span>] == <span class="string">'?'</span> || str1[i - <span class="number">1</span>] == str2[j - <span class="number">1</span>])</span><br><span class="line">				F[i][j] = F[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (str1[i - <span class="number">1</span>] == <span class="string">'*'</span>) &#123;</span><br><span class="line">				F[i][j] = F[i - <span class="number">1</span>][j] || F[i][j - <span class="number">1</span>] || F[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				F[i][j] = <span class="literal">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (F[str1.size()][str2.size()])</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"matched"</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="string">"not matched"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 加了下面两句速度反而变慢了？ shit</span></span><br><span class="line">	ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="number">0</span>);</span><br><span class="line">	<span class="built_in">string</span> str1, str2;</span><br><span class="line">	getline(<span class="built_in">cin</span>, str1);</span><br><span class="line">	getline(<span class="built_in">cin</span>, str2);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; match(str1, str2) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lastgod.github.io/2018/11/30/开餐馆问题/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Author">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hzx's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/11/30/开餐馆问题/" class="post-title-link" itemprop="https://lastgod.github.io/index.html">开餐馆问题</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-11-30 15:00:40" itemprop="dateCreated datePublished" datetime="2018-11-30T15:00:40+08:00">2018-11-30</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-12-03 10:17:17" itemprop="dateModified" datetime="2018-12-03T10:17:17+08:00">2018-12-03</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<p>北大信息学院的同学小明毕业之后打算创业开餐馆.现在共有n 个地点可供选择。小明打算从中选择合适的位置开设一些餐馆。这 n 个地点排列在同一条直线上。我们用一个整数序列m1, m2, … mn 来表示他们的相对位置。由于地段关系,开餐馆的利润会有所不同。我们用pi 表示在mi 处开餐馆的利润。为了避免自己的餐馆的内部竞争,餐馆之间的距离必须大于k。请你帮助小明选择一个总利润最大的方案。</p>
<h2 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h2><h3 id="思路一：将问题专为话最长递增子序列的问题。"><a href="#思路一：将问题专为话最长递增子序列的问题。" class="headerlink" title="思路一：将问题专为话最长递增子序列的问题。"></a>思路一：将问题专为话最长递增子序列的问题。</h3><pre><code>- 假设dp[i]表示选定了第i个位置开餐馆的最大收益，此时递推公式为：
F[i] = max(F[i], F[t]+profit[i]); 其中1&lt;t&lt;i 同时t和i之间的距离大于k
</code></pre><p>在这种思路下，代码如下:<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// pos[i]表示第i个餐馆的位置， profit[j]表示第j个位置开餐馆的利润</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solution1</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; pos, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; profit, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; F(profit);</span><br><span class="line">	<span class="keyword">int</span> ans = profit[<span class="number">1</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; pos.size(); ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i - <span class="number">1</span>; ++j) &#123;</span><br><span class="line">			<span class="keyword">if</span> (pos[i] - pos[j] &gt; k)</span><br><span class="line">				F[i] = max(F[i], F[j] + profit[i]);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">		ans = max(ans, F[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> G;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;G) != EOF) &#123;</span><br><span class="line">		<span class="keyword">while</span> (<span class="number">0</span> &lt; G--) &#123;</span><br><span class="line">			<span class="keyword">int</span> n, k;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;k);</span><br><span class="line">			<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; pos(n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">				<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;pos[i]);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; profit(n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">				<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;profit[i]);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, solution1(pos, profit, k));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="思路二：将问题转化为0-1背包问题"><a href="#思路二：将问题转化为0-1背包问题" class="headerlink" title="思路二：将问题转化为0-1背包问题"></a>思路二：将问题转化为0-1背包问题</h3><pre><code>- 假设dp[i][j]在长度为pos[j]的范围内，考虑前i个餐馆的最大利润，此时递推公式如下：
</code></pre><p>dp[i][j] = max(dp[i-1][j], dp[i-1][pos[i]-k-1]+profit[i]); </p>
<p>上述递推公式虽然涉及到了i和j，但是对背包问题经过空间优化，可以使用1维的数组保留记录。最终代码如下：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solution2</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; pos, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; profit, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">	<span class="comment">// F[i][j] 表示考虑前i个餐馆，前j个位置的最大距离</span></span><br><span class="line">	<span class="comment">// F[i] = max&#123;F[k]+profit[i]&#125;;</span></span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; dp(pos.size(), <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; pos.size(); ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = pos.size()<span class="number">-1</span>; j&gt;=i; --j) &#123;</span><br><span class="line">			<span class="keyword">if</span> (pos[j] &gt;= pos[i])&#123;</span><br><span class="line">				<span class="keyword">int</span> index = i;</span><br><span class="line">				<span class="keyword">while</span>(pos[i] - pos[index] &lt;= k&amp;&amp;index &gt;<span class="number">0</span>)</span><br><span class="line">					--index;</span><br><span class="line">				dp[j] = max(dp[j], dp[index] + profit[i]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> dp[pos.size() - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> G;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;G) != EOF) &#123;</span><br><span class="line">		<span class="keyword">while</span> (<span class="number">0</span> &lt; G--) &#123;</span><br><span class="line">			<span class="keyword">int</span> n, k;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;k);</span><br><span class="line">			<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; pos(n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">				<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;pos[i]);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; profit(n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">				<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;profit[i]);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, solution2(pos, profit, k));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="时间复杂度分析"><a href="#时间复杂度分析" class="headerlink" title="时间复杂度分析"></a>时间复杂度分析</h2><ul>
<li>第一种思路的方法，选定一个i的时候，需要向前遍历距离大于k的位置，因此时间复杂度为O(n^2)$。</li>
<li>第二种思路的方法，看起来有三个循环，但是实际上第二个for循环和while循环加起来总共是O(n)的时间复杂度，所以时间复杂度也是O(n^2)。</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lastgod.github.io/2018/11/29/网络所19晚会/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Author">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hzx's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/11/29/网络所19晚会/" class="post-title-link" itemprop="https://lastgod.github.io/index.html">北京大学计算机系网络所2018～2019年年会筹备事宜</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-11-29 10:46:00" itemprop="dateCreated datePublished" datetime="2018-11-29T10:46:00+08:00">2018-11-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-12-03 10:17:25" itemprop="dateModified" datetime="2018-12-03T10:17:25+08:00">2018-12-03</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<ul>
<li><p>DB2 P2P 云计算 移动</p>
</li>
<li><p>各组需要通知：</p>
<ul>
<li>学术报告：6篇，报名</li>
<li>poster：10篇，每组一篇</li>
<li>2周时间：确定人选、题目</li>
</ul>
</li>
</ul>
<h1 id="北京大学计算机系网络所2018～2019年年会筹备事宜"><a href="#北京大学计算机系网络所2018～2019年年会筹备事宜" class="headerlink" title="北京大学计算机系网络所2018～2019年年会筹备事宜"></a>北京大学计算机系网络所2018～2019年年会筹备事宜</h1><h2 id="学术报告"><a href="#学术报告" class="headerlink" title="学术报告"></a>学术报告</h2><ul>
<li><p>==DB2 P2P 云计算 移动==</p>
</li>
<li><p>各组需要通知：</p>
<ul>
<li>学术报告：6篇，报名</li>
<li>poster：10篇，每组一篇</li>
<li>2周时间：确定人选、题目</li>
</ul>
</li>
<li><p>活动：</p>
<ul>
<li>签到、抽奖：DB2（2周）<ul>
<li>问卷星</li>
<li>签到</li>
<li>抽奖</li>
</ul>
</li>
<li>茶歇食品：P2P（3周）</li>
<li>poster奖品、学术报告奖品：云计算、移动（3周）</li>
<li>主持人一个：关玉烁</li>
<li>poster统一打印、自己布置</li>
</ul>
<h2 id="嘉年华"><a href="#嘉年华" class="headerlink" title="嘉年华"></a>嘉年华</h2></li>
<li><p>==天网==</p>
</li>
<li><p>活动：（1个月）</p>
<ul>
<li>游戏规则、分数设置统计（2周）：各组组长，给体育委员审核</li>
<li>游戏积分汇总<ul>
<li>共享表格</li>
</ul>
</li>
<li>食品、奖品</li>
</ul>
</li>
</ul>
<h2 id="晚会"><a href="#晚会" class="headerlink" title="晚会"></a>晚会</h2><ul>
<li>==DB1、DB2、DB3、DB4、AI、虚拟化==</li>
<li>活动：<ul>
<li>节目报备：2周</li>
<li>主持人：肖克成、屈笑如</li>
<li>场地布置、设备调试、奖品保管、颁发统计：DB1</li>
<li>打扫卫生：DB3</li>
<li>签到、抽奖、投票：DB2</li>
<li>ppt播放、ppt制作：AI</li>
<li>奖品、零食、道具及其他可能采买：DB4（2周）-》班长审核</li>
<li>全员纪念品、请帖（晚会）、海报：虚拟化，班长验收（一个月）</li>
<li>摄影：虚拟化</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lastgod.github.io/2018/11/24/以太坊中的智能合约/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Author">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hzx's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/11/24/以太坊中的智能合约/" class="post-title-link" itemprop="https://lastgod.github.io/index.html">以太坊中的智能合约</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-11-24 19:59:14" itemprop="dateCreated datePublished" datetime="2018-11-24T19:59:14+08:00">2018-11-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-12-03 10:17:09" itemprop="dateModified" datetime="2018-12-03T10:17:09+08:00">2018-12-03</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<h1 id="以太坊中的智能合约（Smart-Coantract）"><a href="#以太坊中的智能合约（Smart-Coantract）" class="headerlink" title="以太坊中的智能合约（Smart Coantract）"></a>以太坊中的智能合约（Smart Coantract）</h1><h2 id="创建智能合约"><a href="#创建智能合约" class="headerlink" title="创建智能合约"></a><strong>创建智能合约</strong></h2><p>以太坊中的智能合约是运行在区块链上的一段代码，代码的逻辑定义了合约的内容。合约的账户保存了合约当前的运行状态，主要包含了4部分内容。</p>
<ul>
<li>balance：当前余额</li>
<li>nonce：  交易次数</li>
<li>code：   合约代码</li>
<li>storge： 存储，是一棵MPT</li>
</ul>
<p>智能合约一般使用Solidity语言进行编写，语法上与JavaScript相似。如下是一段Solidity编写的智能合约的代码,这段代码是一个商品拍卖的智能合约。所有参与拍卖的人员对商品进行竞价，每次竞价时都会将相应的价格发送到智能合约中，合约会自动记录竞价人的报价，拍卖结束时，出价最高者获得拍卖品，同时出价最高者的钱会发送给受益人。其他人可以使用withDraw函数拿回自己的钱。代码详细内容见注释。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">pragma solididity ^<span class="number">0.4</span><span class="number">.21</span>               <span class="comment">// 声明使用的solidity版本</span></span><br><span class="line"></span><br><span class="line">contract SimpleAuction&#123;                 <span class="comment">// 声明一个SimplaAuction的合约类</span></span><br><span class="line">    address <span class="keyword">public</span> beneficiary;         <span class="comment">// 拍卖受益人</span></span><br><span class="line">    uint <span class="keyword">public</span> auctionEnd;             <span class="comment">// 拍卖截止日期</span></span><br><span class="line">    address <span class="keyword">public</span> highestBidder;       <span class="comment">// 当前的最高出价人</span></span><br><span class="line">    mapping(address =&gt; uint) bids;      <span class="comment">// 所有竞拍者的出价，map结构</span></span><br><span class="line">    address[] bidders;                  <span class="comment">// 所有竞拍者数组</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 需要记录的事件,event主要用来记录日志</span></span><br><span class="line">    <span class="function">event <span class="title">HighestBidIncreased</span><span class="params">(address bidder, uint amount)</span></span>; <span class="comment">// 出价最高的人发生变动</span></span><br><span class="line">    <span class="function">event <span class="title">Pay2Beneficiary</span><span class="params">(address winner, uint amount)</span></span>;     <span class="comment">// 竞拍成功者的钱发送给受益人</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/// constructor是构造函数</span></span><br><span class="line">    <span class="comment">/// _biddingTime 表示拍卖时长</span></span><br><span class="line">    <span class="comment">/// _beneficiary 表示拍卖受益人</span></span><br><span class="line">    constructor(uint _biddingTime, address _beneficiary) <span class="keyword">public</span></span><br><span class="line">    &#123;</span><br><span class="line">        beneficiary = _beneficiary;</span><br><span class="line">        auctionEnd = now + _biddingTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// 对拍卖进行竞价，如果之前出过价，就会把之前的价格与当前价格求和作为竞价</span></span><br><span class="line">    <span class="function">function <span class="title">bid</span><span class="params">()</span> <span class="keyword">public</span> payable</span>&#123;...&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/// 参与投标的人在拍卖结束后取回自己的钱</span></span><br><span class="line">    <span class="function">function <span class="title">withdraw</span><span class="params">()</span> <span class="keyword">public</span> <span class="title">returns</span><span class="params">(<span class="keyword">bool</span>)</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// 结束拍卖，将最高出价的钱发送给受益人</span></span><br><span class="line">    <span class="function">function <span class="title">pay2Beneficiary</span><span class="params">()</span> <span class="keyword">public</span> <span class="title">returns</span><span class="params">(bools)</span></span>&#123;&#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>智能合约的构造函数名，最新版本使用constructor关键字，不推荐使用类名命名构造函数。构造函数只能有<strong>1</strong>个。构造函数仅仅在合约创建的时候调用一次。</p>
</li>
<li><p>bid()函数中，可以看到有一个 <strong>payable</strong> 关键字。如果一个函数添加了关键字payable，表明该函数接受转账，如果一个函数不写payable关键字，表明该函数不接受转账。</p>
</li>
<li><p>bid()函数， withdraw()函数，pay2Beneficiary()函数是成员函数，他们有public修饰，表示可供外部调用。</p>
</li>
<li><p>solidity中的map，其结构不支持遍历，这就意味着需要手动记录map中的元素。一般使用数组进行记录。上述代码中使用bidders记录参与竞拍的人。solidity中的数组元素既可以是定长数组，也可以是可变数组。</p>
</li>
</ul>
<p>编写好智能合约之后，如何将该智能合约发布到区块链上呢？在以太坊中，发布一个智能合约，只需要将该合约的内容写入到一笔交易即可。具体过程如下：</p>
<ol>
<li>利用一个外部帐户发起一个转账交易，这笔交易的收款地址为<strong>0x0</strong>，转账金额设置为0。</li>
<li>将智能合约代码编译为二进制字节码，并将这些二进制字节码写入交易的<strong>data</strong>域。</li>
<li>填写交易其他部分内容。</li>
<li>发布交易，交易执行完毕后会返回智能合约的地址。</li>
</ol>
<p>通过上述步骤就可以创建一个智能合约，以后调用智能合约时就将交易的收款地址写为智能合约的地址即可。</p>
<h2 id="调用智能合约"><a href="#调用智能合约" class="headerlink" title="调用智能合约"></a><strong>调用智能合约</strong></h2><p>智能合约无法主动执行，因此智能合约要么是被外部帐户调用，要么被其他智能合约调用，外部账户调用智能合约和内部账户调用智能合约的方法有所不同，下文将分别予以说明。</p>
<h3 id="外部账户调用智能合约"><a href="#外部账户调用智能合约" class="headerlink" title="外部账户调用智能合约"></a><strong>外部账户调用智能合约</strong></h3><p>外部账户调用智能合约时，具体步骤如下：</p>
<ul>
<li>创建一笔交易，交易的收款地址为要调用的智能合约的地址。</li>
<li>把要调用的函数名称和以及该函数需要的参数进行编码，随后填入data域中。</li>
<li>如果调用的函数有关键字payable修饰，即该合约接收转账，那么该函数中用到的转账金额则放在交易的value域中。</li>
<li>填写其他交易内容，发布交易。</li>
<li>矿工收到该交易后，本地执行该交易，将执行结果打包到区块中，发布区块。</li>
</ul>
<p>下图中的接收地址中填入了调用的智能合约地址，data域中填入了要调用的函数和参数的编码值，value为0。</p>
<div align="center"><br><br><img src="https://img-blog.csdnimg.cn/20181124194719817.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Q0NjQxNDcwNDE1MmFiYw==,size_16,color_FFFFFF,t_70.png" alt="Alt text" title="optional title"><br><br></div>

<h3 id="智能合约账户调用智能合约"><a href="#智能合约账户调用智能合约" class="headerlink" title="智能合约账户调用智能合约"></a><strong>智能合约账户调用智能合约</strong></h3><p>智能合约之间的调用则不需要通过发布交易进行，而是直接使用代码进行交互，调用的方法一般分为2种：</p>
<ol>
<li>创建被调用合约对象后直接调用相关成员函数。</li>
<li>使用address类型的call()函数。</li>
</ol>
<p>创建对象后直接使用的示例代码如下。</p>
<pre><code>contract A{
    event LogCallFoo(string str);               // 定义一个事件
    function constructor(address addr) public{} // 构造函数 
    function foo(string str) return (uint){     
        emit LogCallFoo(str);                   // 写日志操作
        return 123;
    }
}

contract B{
    uint ua;
    // 在合约B中创建合约A的对象，然后调用A中的foo()函数，返回结果存在ua中
    function callAFooDirectly(address addr) public {
        A a = A(addr);
        ua = a.foo(&quot;call foo directly&quot;);
    }
}
</code></pre><p>在上述示例代码中，合约B中构建了智能合约A的对象，然后调用了A中的foo函数。如果使用这种调用方式，如果在执行a.foo()的过程中出现了异常，那么callAFooDirectly()函数也会抛出异常。出现这种情况，会直接导致所在的交易回滚，而矿工不会退回执行中收取的交易费。</p>
<p>使用address类型的call()函数的示例代码如下。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">contract C&#123;</span><br><span class="line">    <span class="function">function <span class="title">callAFooByCall</span><span class="params">(address addr)</span> <span class="keyword">public</span> <span class="title">return</span> <span class="params">(<span class="keyword">bool</span>)</span></span>&#123;</span><br><span class="line">        bytes4 funcsig = bytes4(keccak256(<span class="string">"foo(string)"</span>));      <span class="comment">// 将要调用的函数编码成为4字节 </span></span><br><span class="line">        <span class="keyword">if</span>(addr.call(funcsig, <span class="string">"call foo by func call"</span>))         <span class="comment">// address.call形式调用</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>上述addr.call(funcsig,”call foo by func call”)中，funcsig表示被调用函数的签名，funcsig是一个4字节大小的参数。而”call foo by func call”则是被调用函数的参数。被调用函数的参数会被扩展成为32字节。</li>
<li>如果函数执行成功，则会返回true，执行失败或者引发异常，则会返回false。</li>
<li>上述示例中的addr变量，隶属于Address类型，指的是被调用的智能合约的地址。</li>
<li>和第一种调用函数方法相比，使用address.call(),<strong>即使被调用函数失败，也不会引起交易回滚</strong>。</li>
</ul>
<p>实际上，还有另外一种智能合约调用方式，即使用delegatecall方法，而delegatecall则类似于我们的函数调用，delegatecall函数中使用的所有上下文参数，均来自于调用发起合约，而不是被调用的合约。</p>
<p>调用智能合约更多详细信息，参考<a href="https://solidity-cn.readthedocs.io/zh/develop/types.html#members-of-addresses" target="_blank" rel="noopener">solidity中文文档</a></p>
<p>至此，调用智能合约的方法基本叙述完毕，而伴随着智能合约另外一些特征，本文也会予以介绍。</p>
<h2 id="智能合约中的fallback-函数"><a href="#智能合约中的fallback-函数" class="headerlink" title="智能合约中的fallback()函数"></a><strong>智能合约中的fallback()函数</strong></h2><p>fallback()是一个很特殊的函数。它是智能合约中的一个<strong>匿名</strong>函数，这个函数没有名称、没有参数，也没有返回值，只有访问类型和函数体。其形式如下：<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">funcion() <span class="keyword">public</span> [payable]&#123;...&#125;</span><br></pre></td></tr></table></figure></p>
<p>匿名函数只有如下两种情况下才会被调用：</p>
<ol>
<li>向某个合约地址转账，data域为空时。</li>
<li>向某个合约地址转账，data域中填写函数在智能合约中不存在时</li>
</ol>
<p>用一句话总结，就是data域中的数据被解析后找不到一个可以匹配的函数，就会调用fallback()函数。</p>
<p>fallback()函数仍然可以用payable修饰，添加了payable函数之后表明匿名函数接收转账，如果没有payable，表明该函数不接收转账。如果匿名函数没有payable的情况下转账金额不是0，此时执行fallback()函数就会抛出异常。</p>
<h2 id="汽油费-gas-fee"><a href="#汽油费-gas-fee" class="headerlink" title="汽油费(gas fee)"></a><strong>汽油费(gas fee)</strong></h2><p>智能合约的设计语言solidity是图灵完备语言，这就意味着智能合约中可以包括循环。随之而来的问题是，如果智能合约中出现死循环怎么办？而程序在执行之前无法判断是否会出现死循环。因此，智能合约中引入了汽油费。智能合约执行在EVM中，EVM对执行指令进行了标价，每执行一条指令，就需要消耗相应的汽油，不同的指令因为复杂程度不同，消耗的汽油量会有所不同。</p>
<p>回想一下以太坊中一笔交易的结构：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">type txdata <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    AccountNonce    uint;                   <span class="comment">// 交易次数</span></span><br><span class="line">    GasPrice        *bit.Int;               <span class="comment">// 单位汽油价格</span></span><br><span class="line">    GasLimit        uint64;                 <span class="comment">// 本交易愿意支付的最大汽油量</span></span><br><span class="line">    Recipient       *common.Address         <span class="comment">// 接收账户地址</span></span><br><span class="line">    Amount          *big.Int                <span class="comment">// 转账金额</span></span><br><span class="line">    Payload         []byte                  <span class="comment">// data域</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>每个交易中都有一个gas limit字段，表明发起交易方最多支出的汽油量，另外，交易中的gas price字段表明交易发起方对每单位的汽油出的价格，gas price*gas limit就是这笔交易消耗的最大汽油费。</li>
<li>如果执行中出现了死循环，执行所需要的gas fee就会超额，此时EVM就会强行停止智能合约的执行，并且回滚之前的所有操作，但之前执行消耗的汽油费不会退回给交易发起方，这样就能有效的防止死循环，同时避免以太坊中的节点收到Denial of Service攻击。</li>
</ul>
<h3 id="智能合约中的条件判断"><a href="#智能合约中的条件判断" class="headerlink" title="智能合约中的条件判断"></a><strong>智能合约中的条件判断</strong></h3><p>以太坊中的交易进行执行，可以看作是一个原子操作，要么全部执行完毕，完成转账；如果执行抛出异常，则执行中的操作全部回滚。所以智能合约在执行时有如下条件判断的语句，在执行前会判断条件，说明如下：</p>
<ul>
<li>智能合约中不存在自定义的try-catch的结构。</li>
<li>智能合约执行过程中遇到异常，除非特殊情况，否则本次的执行操作会全部回滚。</li>
<li>solidity中可以抛出错误的语句有：<ul>
<li>assert(bool condition):如果条件不满足就会抛出错误，用于抛出内部错误，和c++中的assert相同，可以用于Debug。</li>
<li>require(bool condition):如果条件不满足，也抛出错误，用于检测外部输入条件是否合法。</li>
<li>revert():无条件抛出异常，终止运行并且回滚状态变动。</li>
</ul>
</li>
</ul>
<h3 id="智能合约执行中可以调用的变量"><a href="#智能合约执行中可以调用的变量" class="headerlink" title="智能合约执行中可以调用的变量"></a><strong>智能合约执行中可以调用的变量</strong></h3> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取给定区块的哈希值，只能获取最近的256个区块，不包括当前区块。   </span></span><br><span class="line">block.blockhash(uint blockNumber) returns (bytes32)                                                  </span><br><span class="line">block.coinbase(address)                 <span class="comment">// 挖出当前区块的矿工地址                 </span></span><br><span class="line">block.difficulty(uint)                  <span class="comment">// 当前区块的难度</span></span><br><span class="line">block.gaslimit(uint)                    <span class="comment">// 当前区块的gas限额</span></span><br><span class="line">block.number(uint)                      <span class="comment">// 当前区块号</span></span><br><span class="line">block.timestamp(uint)                   <span class="comment">// 当前区块以秒计数的时间戳</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 如下是智能合约可以获得的调用信息</span></span><br><span class="line">msg.data        (bytes)                 <span class="comment">// 完整的调用信息(calldata)</span></span><br><span class="line">mas.gas         ( uint)                 <span class="comment">// 剩余的gas</span></span><br><span class="line">mas.sender      (address)               <span class="comment">// 消息发送者(当前调用)</span></span><br><span class="line">msg.sig         (bytes4)                <span class="comment">// calldata的前4字节（即函数标识符）</span></span><br><span class="line">msg.value       (uint)                  <span class="comment">// 随消息发送的wei的数量</span></span><br><span class="line">now             (uint)                  <span class="comment">// 目前区块的时间戳(和前面的block.timestamp相同)</span></span><br><span class="line">tx.gasprice     (uint)                  <span class="comment">// 交易的gas价格</span></span><br><span class="line">tx.origin       (address)               <span class="comment">// 交易发起者</span></span><br></pre></td></tr></table></figure>
<p>需要说明的有如下两点：</p>
<ul>
<li>智能合约调用的信息，全部是变量，而不是函数调用，括号中的类型，是这些变量的返回类型。</li>
<li>msg.sender和tx.origin是有区别的，msg.sender表示调用当前合约的地址，不一定是交易的发起者。因为一笔交易中发起的合约A可以调用合约B，此时对于B来说，msg.sender是A，tx.origin是交易发起者。</li>
</ul>
<h3 id="智能合约中的地址类型"><a href="#智能合约中的地址类型" class="headerlink" title="智能合约中的地址类型"></a><strong>智能合约中的地址类型</strong></h3><table>
<thead>
<tr>
<th>变量</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>address.balance</td>
<td>成员<strong>变量</strong>，uint256类型</td>
<td>返回uint256类型，返回address中以Wei计量的余额</td>
<td></td>
</tr>
<tr>
<td>address.transfer(uint256 amount)</td>
<td>成员<strong>函数</strong>，</td>
<td>向address所在的地址发送amount数量的Wei，失败时抛出异常，发送2300gas矿工费，该矿工费不可调节。</td>
<td></td>
</tr>
<tr>
<td>address.send(uint256 amount)</td>
<td>成员<strong>函数</strong>，return (bool)</td>
<td>向address发送amount书来那个的Wei，失败时返回false，调用时发送2300的gas矿工费，该矿工费不可调节。</td>
<td></td>
</tr>
<tr>
<td>address.call(…)</td>
<td>成员<strong>函数</strong>，return (bool)</td>
<td>发出底层CALL,失败返回false,发送所有可用的gas进行调用,发送的gas不可调节。</td>
<td></td>
</tr>
<tr>
<td>address.callcode(…)</td>
<td>成员<strong>函数</strong>，return (bool)</td>
<td>发出底层CallCODE,失败时返回false，发送所有可用的gas，发送的gas不可调节。</td>
<td></td>
</tr>
<tr>
<td>address.delegatecall(…)</td>
<td>成员<strong>函数</strong>，return (bool)</td>
<td>调用底层DELEGATECALL，失败返回false，发送所有可用gas发送的gas不可调节</td>
<td></td>
</tr>
</tbody>
</table>
<p>注意：所有智能合约都可以显式的转换称地址类型。transfer和send以及call都可以用来进行转账，区别在于发送的汽油费不同。                                         </p>
<h3 id="智能合约执行中的一些问题"><a href="#智能合约执行中的一些问题" class="headerlink" title="智能合约执行中的一些问题"></a><strong>智能合约执行中的一些问题</strong></h3><ul>
<li><p>矿工执行某个调用智能合约的交易，执行过程中出错，是否需要发布到区块链上？</p>
<ul>
<li>答：需要发布到区块链上，虽然执行失败，但是需要扣掉gas fee，发布到区块链上，其他矿工执行失败时也相应的扣掉汽油费，只不过此时扣掉的汽油费不是转给自己，而是转给发布区块的矿工账户。</li>
</ul>
</li>
<li><p>先执行智能合约再发布区块，还是先发布区块再执行智能合约？</p>
<ul>
<li>答：先执行智能合约，再发布到区块。每一个新发布区块中最新的三个状态树、交易树、收据树的哈希值，都是执行完智能合约之后才能得到。挖到区块的矿工发布区块之后，其他矿工随之执行新区块中的交易，同步更新本地存储的状态树、交易树和收据树，以此维持数据同步。</li>
</ul>
</li>
</ul>
<ul>
<li>智能合约支持多线程吗？<ul>
<li>智能合约的solidity不支持多线程。以太坊是一个交易驱动的状态机，因此面对同一种输入，必须到达一个确定的状态。但是多线程的问题在于多核对内存访问顺序不一样，就会引起状态变化，这不利于维护区块链中状态的一致性。同时，其他可能造成不一致的操作，智能合约也不支持。最明显的例子就是以太坊中的智能合约没办法产生真正意义下的随机数。</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lastgod.github.io/2018/11/24/post-office问题/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Author">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hzx's Home">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/11/24/post-office问题/" class="post-title-link" itemprop="https://lastgod.github.io/index.html">post_office问题</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-11-24 19:58:45" itemprop="dateCreated datePublished" datetime="2018-11-24T19:58:45+08:00">2018-11-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-12-03 10:15:17" itemprop="dateModified" datetime="2018-12-03T10:15:17+08:00">2018-12-03</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <a id="more"></a>
<h1 id="Post-Office-修建问题。"><a href="#Post-Office-修建问题。" class="headerlink" title="Post Office 修建问题。"></a>Post Office 修建问题。</h1><p>地址： <a href="http://noi.openjudge.cn/ch0206/162/" target="_blank" rel="noopener">http://noi.openjudge.cn/ch0206/162/</a></p>
<h2 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h2><p>设置F[p][v]表示V个village中修建p个邮局使得所有村庄到最近邮局的距离最近。<br>得到了如下递推公式：<br>F[p][v] = min{F[p][v], F[p-1][k-1]+ dis[k][v]};<br>为什么这样进行递推？这是因为本题目中以最后一个邮局所属的村庄进行划分，因为总有一些village到最后一个邮局的距离是最近的，但是这些村子的数量不知道，我们需要知道到底多少village划归到最后一个post office的时候是最优的。<br><!-- more --></p>
<p>#####隐藏内容<br>但是我们知道，能够划分到最后一个post office的village，至少是第p个，修建之前的p-1个post office，至少需要p-1个village。因此有如下等式：</p>
<center>p-1&lt;=k-1&lt;=v</center>


<p>递推式表示在前面k-1个village中修建p-1个post office，随后的第k个village到第v个village，修建最后一个post office， dis[k][v]表示在第k个village和第v个village中修建1个post office时各个village到这个post office的距离之和的最小值。</p>
<p>现在需要解决如下问题，dis[k][v]如何计算？<br>在k和v之间修建一个post office，同时所有village到该post office的距离最小，该如何计算呢？正确计算方法是将post office修建到这些village的中位数中。</p>
<p>假设范围是i和j-1之间的中位数中修建了一个post office，最优值为dis[i][j-1],现在当新加入一个village j之后。假设i和j-1之间的中位数是K，新加入j之后选择L作为新的post office 位置。现在分情况讨论：</p>
<ul>
<li>如果原本i和j之间有奇数个village，新加入一个j之后，仍然可以取原来的K作为中位数，此时中位数位置不变，所以<br>  <center><br>  dis[i,j] = dis[i,j-1]+village[j] - village[(j+i)/2]  <center></center></center></li>
<li>如果原本i和j之间有偶数个village，假设此时post office的修建地址设置为中位数中较大的数的位置，此时新加入j后，post office的位置不发生改变，那么仍然由如下计算公式：  <center><br>  dis[i,j] = dis[i,j-1]+village[j] - village[(j+i)/2]<br>  <center><br>综上，可以得出:<br>  <center><br>  dis[i,j] = dis[i,j-1]+village[j] - village[(j+i)/2]<br>  </center>


</center></center></li>
</ul>
<h2 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;climits&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solution</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; village, <span class="keyword">int</span> officeCount)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; F(officeCount + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(village.size(), <span class="number">0</span>));</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; dis(village.size(), <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(village.size(), <span class="number">0</span>));</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; village.size(); ++i)&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt; village.size(); ++j) &#123;</span><br><span class="line">			<span class="keyword">int</span> k1 = (i + j - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">int</span>  k2 = (i + j) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			dis[i][j] = dis[i][j - <span class="number">1</span>] + village[j] - village[(i+j)/<span class="number">2</span>];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> v = <span class="number">1</span>; v &lt; village.size(); ++v)</span><br><span class="line">		F[<span class="number">1</span>][v] = dis[<span class="number">1</span>][v];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">2</span>; p &lt;= officeCount; ++p)&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> v = p; v &lt; village.size(); ++v) &#123;</span><br><span class="line">			F[p][v] = INT_MAX;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = p; k &lt;=v; ++k)</span><br><span class="line">				F[p][v] = min(F[p][v],F[p<span class="number">-1</span>][k<span class="number">-1</span>]+dis[k][v]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> F[officeCount][village.size() - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> V, P;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;V, &amp;P) != EOF) &#123;	</span><br><span class="line">		<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; village(V+<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= V; ++i)</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;village[i]);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,solution(village, P));</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h2><p>上述代码的时间复杂度为O(pV^2)</p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Author</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">7</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Author</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v6.6.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.6.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.6.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.6.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.6.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.6.0"></script>



  



  










  





  

  

  

  

  

  
  

  

  

  

  

  

  

</body>
</html>
